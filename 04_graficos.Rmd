---
output: 
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      ratio: 16:9
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
background-image: url(www/slide1.png)
background-size: cover

<link rel="stylesheet" type="text/css" href="www/enap.css">


---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE, max.print = 30, digits = 4)
library(tidyverse)

theme_set(
  theme_grey() + theme(legend.position = "top")
)
knitr::opts_chunk$set(
  warning = FALSE, message = FALSE, 
  fig.align = "center", fig.retina = 2, cache = TRUE
)
knitr::opts_hooks$set(fig.callout = function(options) {
  if (options$fig.callout) {
    options$echo <- FALSE
    options$out.width <- "100%"
    options$out.height <- "97%"
  }
  options
})
knitr::opts_hooks$set(fig.principal = function(options) {
  if (options$fig.principal) {
    options$echo <- FALSE
    options$fig.width <- 10
    options$fig.height <- 6
    options$out.width <- "75%"
  }
  options
})
```

# Percurso do curso

<br/>
<br/>

1. Noções de **R**

2. Ciclo da ciência de dados e tidyverse

3. União de dados

4. Lidando com textos

5. Funções

6. **Comunicação: Gráficos**

7. **Comunicação: Markdown e shiny**

---

# Percurso de hoje

1. Etiquetas

2. Anotações

3. Escalas

4. Zoom

5. Temas

6. Exportando gráficos

---

# Dados

```{r}
imdb <- read_rds("dados/imdb.rds")

filmes_recentes <- imdb %>% 
  filter(ano >= 2015) %>% 
  mutate(orcamento = orcamento / 1000000,
         receita = receita / 1000000, # em milhões
         lucro = receita - orcamento) 
```

---

# Gráfico base

.pull-left[
```{r prep, eval=FALSE}
colorido <- ggplot(
  filmes_recentes, 
  aes(duracao, receita, col = classificacao)
  ) + geom_point()

colorido
```
]

.pull-right[
```{r, ref.label="prep", fig.callout = TRUE}
```
]

---

# Etiquetas

.pull-left[
```{r label-1, eval=FALSE}
colorido +
  labs(
    title = "Filmes após 2015",
    subtitle = "Subtítulo do gráfico",
    caption = "Fonte: IMDb"
  )
```
]

.pull-right[
```{r, ref.label="label-1", fig.callout = TRUE}
```
]

---

# Etiquetas

.pull-left[
```{r label-2, eval=FALSE}
colorido +
  labs(
    x = "Duração (em minutos)",
    y = "Receita (em milhões de US$)",
    col = "Classificação"
  )
```
]

.pull-right[
```{r, ref.label="label-2", fig.callout = TRUE}
```
]

---

# Anotações

```{r}
label <- tibble(
  duracao = 100,
  receita = 220,
  label = "Teto para maioria dos filmes"
)
```

---

# Anotações

.pull-left[
```{r anotacoes, eval=FALSE}
ggplot(
  filmes_recentes, 
  aes(duracao, receita)
  ) + 
  geom_point() +
  geom_text(aes(label = label), 
            data = label, size = 5)
```
]

.pull-right[
```{r, ref.label="anotacoes", fig.callout = TRUE}
```
]

---

# Escalas

.pull-left[
```{r escalas-1, eval=FALSE}
colorido
```
]

.pull-right[
```{r, ref.label="escalas-1", fig.callout = TRUE}
```
]

---

# Escalas

.pull-left[
```{r escalas-2, eval=FALSE}
colorido +
  scale_x_continuous() +
  scale_y_continuous() +
  scale_colour_discrete()
```
]

.pull-right[
```{r, ref.label="escalas-2", fig.callout = TRUE}
```
]

---

# Escalas

.pull-left[
```{r escalas-3, eval=FALSE}
colorido +
  scale_y_continuous(
    breaks = seq(100, 500, 100)
  )
```
]

.pull-right[
```{r, ref.label="escalas-3", fig.callout = TRUE}
```
]

---

# Escalas

.pull-left[
```{r escalas-4, eval=FALSE}
colorido +
  scale_y_continuous(labels = NULL)
```
]

.pull-right[
```{r, ref.label="escalas-4", fig.callout = TRUE}
```
]

---

# Escalas

.pull-left[

A legenda pode ser posicionada em "top", "bottom",  "left",  "right".

```{r escalas-5, eval=FALSE}
colorido +
  theme(legend.position = "left")
```
]

.pull-right[
```{r, ref.label="escalas-5", fig.callout = TRUE}
```
]

---

# Escalas

.pull-left[

As escalas padrões podem ser substituídas.

```{r escalas-6, eval=FALSE}
colorido +
  scale_colour_brewer(palette = "Set1")
```
]

.pull-right[
```{r, ref.label="escalas-6", fig.callout = TRUE}
```
]

---

# Escalas

.pull-left[

As escalas padrões podem ser substituídas.

```{r escalas-7, eval=FALSE}
colorido +
  scale_colour_manual(values = c(
    "A partir de 13 anos" = "orange",
    "Livre" = "darkblue", 
    "Outros" = "gray", 
    "A partir de 18 anos" = "#ff0000"
))

```
]

.pull-right[
```{r, ref.label="escalas-7", fig.callout = TRUE}
```
]

---

# Temas

.pull-left[
```{r temas-1, eval=FALSE}
colorido +
  theme_bw()
```
]

.pull-right[
```{r, ref.label="temas-1", fig.callout = TRUE}
```
]

---

# Temas

.pull-left[
```{r temas-2, eval=FALSE}
colorido +
  theme_dark()
```

Para conhecer outros temas acesse: 
[este endereço](https://github.com/jrnold/ggthemes)

]

.pull-right[
```{r, ref.label="temas-2", fig.callout = TRUE}
```
]

---

# Exportando gráficos

O `ggplot2` disponibiliza uma função para salvar gráficos.

```{r}
# salva o último gráfico
ggsave("grafico.pdf") # sabe que é pdf 
ggsave("grafico.png") # sabe que é imagem
```

---

# Exportando gráficos

Para salvar de uma imagem podemos usar `pdf()` ou `png()`. 

Nesse casos lembre de "desligar" o "modo salvar".

```{r, eval = FALSE}
pdf("grafico.pdf") # ou png("grafico.png")
meu_grafico1
meu_grafico2
meu_grafico3
dev.off()
```

Atenção! Os gráficos param de aparecer no RStudio quando o 
"modo salvar" estiver ligado.

---

# Relatórios

---





